<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>📶 مراجعة الشبكات المحلية اللاسلكية WLAN</title>
  <style>
    :root{
      --bg:#0f172a;        /* slate-900 */
      --card:#111827;      /* gray-900 */
      --ink:#e5e7eb;       /* gray-200 */
      --muted:#9ca3af;     /* gray-400 */
      --brand:#38bdf8;     /* sky-400 */
      --accent:#22c55e;    /* green-500 */
      --warn:#f59e0b;      /* amber-500 */
      --danger:#ef4444;    /* red-500 */
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:linear-gradient(180deg,#0b1220, #0f172a 30%, #0b1220);
      color:var(--ink); font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Naskh Arabic UI", Tahoma, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .app{ width:min(1000px,100%); }
    header{display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:16px}
    header h1{font-size:clamp(18px,3vw,24px); margin:0; letter-spacing:.3px; color:var(--brand)}
    .controls{display:flex; flex-wrap:wrap; gap:8px; align-items:center}
    button{
      background:#0b1220; color:var(--ink); border:1px solid #263042; border-radius:12px;
      padding:10px 14px; cursor:pointer; font-weight:600; transition:.2s transform ease, .2s background ease;
    }
    button:hover{ transform:translateY(-1px); background:#0b1426 }
    button.primary{ border-color:var(--brand) }
    button.good{ border-color:var(--accent) }
    button.bad{ border-color:var(--danger) }
    input[type="number"], input[type="text"]{ background:#0b1220; color:var(--ink); border:1px solid #263042; border-radius:10px; padding:8px 10px; width:100%; }
    .card{ perspective: 1200px; isolation:isolate; height: clamp(280px, 42vh, 420px); background: transparent; border-radius:16px; position:relative; }
    .card-inner{ position:absolute; inset:0; border-radius:16px; transform-style:preserve-3d; transition: transform .5s cubic-bezier(.2,.8,.2,1); }
    .face{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; text-align:center; padding:28px; background: radial-gradient(1200px 400px at 100% 0%, #0b1426, var(--card)); border:1px solid #1f2937; border-radius:16px; backface-visibility:hidden; box-shadow: 0 10px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03); }
    .face.back{ transform: rotateY(180deg); background:#0f1a2e }
    .flipped .card-inner{ transform: rotateY(180deg); }
    .meta{display:flex; align-items:center; gap:10px; opacity:.9; font-size:14px}
    .pill{border:1px dashed #2b3450; padding:4px 10px; border-radius:999px}
    .muted{color:var(--muted)}
    .progress{height:10px; background:#162033; border-radius:999px; overflow:hidden; border:1px solid #263042; margin-top:12px}
    .bar{height:100%; width:0%; background:linear-gradient(90deg, var(--brand), #60a5fa); transition:width .3s ease}
    .panel{background:#0b1426; border:1px solid #263042; border-radius:16px; padding:16px}
    .small{font-size:12px; opacity:.85}
    .hidden{display:none}
    .exbox{ margin-top:12px; padding:14px 16px; border-radius:14px; line-height:1.7; border:1px solid #26425a; background:linear-gradient(180deg,#0b1426,#0c162a); box-shadow: inset 0 1px 0 rgba(255,255,255,.04), 0 8px 24px rgba(0,0,0,.25); }
    .exbox h4{margin:0 0 6px 0; font-size:14px; color:#7dd3fc}
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#0a1220; border:1px solid #263042; border-radius:6px; padding:0 6px}
    .quizbox{ margin-top:12px; padding:16px; border-radius:14px; border:1px solid #334155; background:linear-gradient(180deg,#0c1528,#0f1a30); box-shadow: inset 0 1px 0 rgba(255,255,255,.04), 0 8px 24px rgba(0,0,0,.25); }
    .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    .score{font-weight:700}
    .tag{border:1px solid #2b3450; padding:2px 8px; border-radius:999px; font-size:12px}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>📶 مراجعة الشبكات المحلية اللاسلكية WLAN –<br> م. تبيل الشويكان</h1>
      <div class="controls">
        <button id="btnFlip" class="primary" title="المسطرة: مفتاح المسافة">اقلب البطاقة ▯</button>
        <button id="btnPrev" title="السهم الأيمن/الأيسر">◀ السابقة</button>
        <button id="btnNext" title="السهم الأيمن/الأيسر">التالي ▶</button>
        <button id="btnGood" class="good" title="رقم 1">عرفتها ✓</button>
        <button id="btnBad" class="bad" title="رقم 2">لا، أعِدها ✗</button>
        <button id="btnShuffle" title="خلط البطاقات">🔀 خلط</button>
        <span class="tag" id="timer" title="الوقت المتبقي" style="margin-inline-start:8px">⏱️ —</span>
      </div>
    </header>

    <section class="panel" id="studyView">
      <div class="meta" style="margin-bottom:10px">
        <span class="pill" id="deckName">المجموعة: WLAN – مفاهيم + أمان + QoS + أوضاع + أوامر</span>
        <span class="muted">(<span id="idx">1</span>/<span id="total">1</span>)</span>
      </div>
      <div class="card" id="card">
        <div class="card-inner" id="cardInner">
          <div class="face front" id="front"></div>
          <div class="face back" id="back"></div>
        </div>
      </div>
      <div id="ex" class="exbox hidden">
        <h4>شرح مختصر</h4>
        <div id="exText"></div>
      </div>
      <div class="progress" aria-label="نسبة التقدم"><div class="bar" id="bar"></div></div>
      <p class="small muted">اختصارات: مسافة (قلب)، الأسهم يمين/يسار (تنقّل)، 1 (صح)، 2 (إعادة).</p>
    </section>

    <!-- وضع الاختبار -->
    <section class="panel quizbox" id="quizSetup">
      <div class="row">
        <strong>🎯 وضع اختبار سريع</strong>
        <span class="muted">— اختر مدته ثم ابدأ</span>
      </div>
      <div class="row" style="margin-top:8px">
        <label for="mins" class="muted">الدقائق:</label>
        <input id="mins" type="number" min="1" max="60" value="10" style="width:90px" />
        <button id="btnStartQuiz" class="primary">ابدأ الاختبار</button>
        <span class="muted" id="quizInfo"></span>
      </div>
    </section>

    <section class="panel quizbox hidden" id="quizView">
      <div class="row" style="justify-content:space-between">
        <div>
          <span class="score">النتيجة: <span id="score">0</span>/<span id="qtotal">0</span></span>
          <span class="tag" style="margin-inline-start:6px">السؤال <span id="qidx">1</span></span>
        </div>
        <div class="muted">⏱️ <span id="quizTimer">—</span></div>
      </div>
      <div class="meta" style="margin-top:10px"><span class="pill" id="qFront"></span></div>
      <div class="row" style="margin-top:10px">
        <input id="ansInput" type="text" placeholder="اكتب إجابة قصيرة (كلمة/كلمتين)…" />
        <button id="btnSubmit" class="primary">تحقّق</button>
        <button id="btnSkip">تجاوز</button>
        <div id="tfBtns" class="row hidden">
          <button id="btnTrue" class="good">صح</button>
          <button id="btnFalse" class="bad">خطأ</button>
        </div>
      </div>
      <div id="quizFeedback" class="small" style="margin-top:8px"></div>
    </section>

    <section class="panel hidden" id="quizSummary">
      <h3 style="margin:0">📊 نتيجة الاختبار</h3>
      <p class="muted" id="summaryText"></p>
      <div class="row"><button id="btnRetry" class="primary">إعادة الاختبار</button><button id="btnBackStudy">العودة للمراجعة</button></div>
    </section>

    <footer style="margin-top:14px" class="muted small">
      يعمل بالكامل دون مكتبات خارجية. يتم حفظ تقدمك محليًا في المتصفح.
    </footer>
  </div>

  <script>
    // ===== 1) البطاقات: 60 سؤال (نظري 40 + أمان/QoS/أوضاع 10 + أوامر 10) =====
    const cards = [
      // — الأساسيات —
      {front:'ما هي WLAN (Wireless LAN)؟', back:'شبكة محلية لاسلكية', ex:'تمد LAN عبر موجات الراديو (IEEE 802.11) بدل الكابلات.'},
      {front:'تعمل WLAN وفق معيار؟', back:'IEEE 802.11', ex:'عائلة معايير Wi‑Fi لكل الطبقات الدنيا اللاسلكية.'},
      {front:'الطبقات التي يغطيها 802.11؟', back:'L1/L2', ex:'الفيزيائية (Physical) وربط البيانات (Data Link).'},
      {front:'رمز المحطة اللاسلكية؟', back:'STA', ex:'Station: جهاز عميل مثل هاتف/حاسب يتصل بالـAP.'},
      {front:'اختصار نقطة الوصول؟', back:'AP', ex:'Access Point يربط STA بالشبكة السلكية والإنترنت.'},
      {front:'ما SSID (Service Set Identifier)؟', back:'اسم الشبكة', ex:'معرّف منطقي يراه المستخدم عند الاتصال.'},
      {front:'BSSID يُمثّل؟', back:'MAC للـAP', ex:'معرّف فريد لنقطة الوصول (عنوان MAC للراديو).'},
      {front:'BSS (Basic Service Set)؟', back:'خلية تغطية', ex:'مجموعة STA تتصل بنفس AP ضمن تغطية واحدة.'},
      {front:'ESS (Extended Service Set)؟', back:'عدة BSS', ex:'مجموعة APs بنفس SSID تربطها شبكات توزيع (DS).'},
      {front:'مصطلح Association يعني؟', back:'ارتباط', ex:'عملية انضمام STA للـAP بعد المصادقة (Authentication).'},

      // — فيزيائيات وقناة —
      {front:'نطاقا Wi‑Fi الشائعان؟', back:'2.4/5 GHz', ex:'تغطية أوسع في 2.4GHz، سعة قنوات أكبر في 5GHz.'},
      {front:'قنوات 2.4GHz غير المتداخلة (بمعظم الدول)؟', back:'1/6/11', ex:'تفصل بينها 25MHz لتقليل التداخل (غير اليابان).'},
      {front:'عرض القناة Channel Width؟', back:'20/40/80 MHz', ex:'الأوسع = سعة أكبر لكن حساسية أعلى للتداخل.'},
      {front:'DFS (Dynamic Frequency Selection)؟', back:'تحاشي الرادارات', ex:'تتطلب بعض قنوات 5GHz اكتشاف الرادار وتغيير القناة.'},
      {front:'RSSI يعني؟', back:'قوة الإشارة', ex:'Received Signal Strength Indicator لقياس المستوى.'},
      {front:'SNR يعني؟', back:'نسبة إشارة/ضجيج', ex:'Signal-to-Noise Ratio؛ كلما زادت تحسّن المدى/المعدل.'},
      {front:'MCS Index؟', back:'معدل التشكيل', ex:'Modulation & Coding Scheme يحدّد السرعة النظرية.'},
      {front:'التعامل مع التصادمات في Wi‑Fi؟', back:'CSMA/CA', ex:'تجنّب التصادم بالاستماع قبل الإرسال (Collision Avoidance).'},
      {front:'متى يُستخدم RTS/CTS؟', back:'عند خفية العُقد', ex:'يقلّل مشكلة hidden node عبر حجز القناة مؤقتًا.'},
      {front:'Beacon Frames دورها؟', back:'إعلان SSID', ex:'تذيع AP معلومات الشبكة والمقاييس دورياً.'},

      // — إدارة الاتصال —
      {front:'Probe Request/Response؟', back:'استكشاف', ex:'بحث STA عن شبكات وردّ AP بمعلومات الارتباط.'},
      {front:'Authentication في 802.11؟', back:'مصادقة', ex:'مرحلة قبل الارتباط، قد تكون Open أو 802.1X.'},
      {front:'Association/Reassociation؟', back:'ارتباط/إعادة', ex:'انضمام STA للـAP أو الانتقال لAP آخر ضمن ESS.'},
      {front:'Roaming داخل ESS؟', back:'تنقّل', ex:'انتقال STA بين APs بنفس SSID مع الحفاظ على الجلسة.'},
      {front:'هل SSID المخفي يحسّن الأمان؟', back:'لا', ex:'إخفاء الاسم ليس أمانًا حقيقيًا؛ استخدم تشفير قوي.'},
      {front:'WPS آمن للاستخدام دائمًا؟', back:'لا', ex:'قد يُستغل PIN؛ يفضَّل تعطيله في البيئات الحساسة.'},
      {front:'Band Steering؟', back:'توجيه النطاق', ex:'حث الأجهزة القادرة نحو 5GHz لتقليل ازدحام 2.4GHz.'},
      {front:'Co-Channel Interference (CCI)?', back:'تداخل نفس القناة', ex:'APs على القناة نفسها يتشاركون وقت الهواء.'},
      {front:'Adjacent Channel Interference (ACI)?', back:'تداخل قنوات مجاورة', ex:'قنوات متداخلة تسرّب طاقتها فتقل الجودة.'},
      {front:'نسبة تداخل خلية آمنة تقريبيًا؟', back:'15–20%', ex:'تداخل محسوب بين الخلايا لتسهيل التجوال دون فقد.'},

      // — الأمن اللاسلكي —
      {front:'WEP آمن اليوم؟', back:'لا', ex:'ضعيف ويمكن كسره؛ لا يُنصح به إطلاقًا.'},
      {front:'WPA2‑PSK مناسب للمنازل؟', back:'نعم', ex:'مفتاح مشترك مسبقًا؛ حدّث كلمات المرور دوريًا.'},
      {front:'WPA3 يضيف؟', back:'SAE', ex:'مصادقة أكثر أمانًا (Simultaneous Authentication of Equals).'},
      {front:'802.1X يستخدم؟', back:'RADIUS', ex:'مصادقة Enterprise مع EAP عبر خادم AAA.'},
      {front:'EAP اختصار؟', back:'Extensible Auth Protocol', ex:'أطر مصادقة متعددة مثل PEAP/TLS/TTLS.'},
      {front:'Guest WLAN آمن بدون عزل؟', back:'لا', ex:'يتطلب عزل العملاء وPortal وقيود ACL/QoS.'},
      {front:'TKIP مقابل AES؟', back:'AES أفضل', ex:'AES/CCMP أقوى تشفيرًا من TKIP القديم.'},
      {front:'PMF/MFP تعني؟', back:'حماية الإطارات', ex:'Protected Management Frames لمتانة الإدارة ضد العبث.'},
      {front:'Open WLAN بدون تشفير آمن؟', back:'لا', ex:'بدون تشفير، البيانات مكشوفة وسهلة الاعتراض.'},
      {front:'تغيير SSID دوريًا يحسّن الأمان؟', back:'لا', ex:'الأهم التشفير والمصادقة القوية وإدارة المفاتيح.'},

      // — QoS والجودة —
      {front:'WMM يعني؟', back:'Wi‑Fi Multimedia', ex:'أربع فئات أولوية (Voice/Video/Best Effort/Background).'},
      {front:'EDCA مقابل HCCA؟', back:'EDCA شائع', ex:'EDCA آلية أولوية موزعة؛ HCCA مركزية نادرة الاستخدام.'},
      {front:'CAC (Call Admission Control)?', back:'تحكّم قبول المكالمات', ex:'يمنع تحميلًا زائدًا يحطّ من جودة الصوت.'},
      {front:'TID في WMM؟', back:'مُعرّف المرور', ex:'Traffic ID لتعيين إطار إلى فئة أولوية معينة.'},
      {front:'متطلبات الصوت التقريبية؟', back:'SNR>25dB', ex:'تغطية ثابتة، jitter/latency منخفضان، قنوات نظيفة.'},

      // — أوضاع AP والمعمارية —
      {front:'Autonomous AP؟', back:'مستقل', ex:'يدار محليًا دون متحكّم؛ مناسب لنطاقات صغيرة.'},
      {front:'Lightweight AP (LAP)?', back:'تابع لمتحكّم', ex:'يعتمد على WLC عبر CAPWAP لإدارة مركزية.'},
      {front:'CAPWAP يعني؟', back:'نفق تحكّم/بيانات', ex:'Control And Provisioning of Wireless APs لإدارة الـAP.'},
      {front:'Split‑MAC Architecture؟', back:'تقسيم الوظائف', ex:'بعض المهام على AP وأخرى على WLC لتحسين الكفاءة.'},
      {front:'أوضاع AP الشائعة؟', back:'Local/Monitor', ex:'كذلك FlexConnect/Mesh/Sniffer وفق السيناريو.'},

      // — تصميم: SOHO مقابل Enterprise —
      {front:'SOHO Wireless Router يضم؟', back:'Router+AP+Switch', ex:'جهاز منزلي يدمج الوظائف مع جدار ناري غالبًا.'},
      {front:'Enterprise WLAN يفضّل؟', back:'WLC مركزي', ex:'إدارة موحّدة للسياسات، تجوال، قنوات، طاقة.'},
      {front:'Captive Portal يُستخدم لـ؟', back:'ضيوف', ex:'مصادقة/قبول شروط قبل الوصول للإنترنت.'},
      {front:'Site Survey نوعان؟', back:'Passive/Active', ex:'قياسات تغطية فعلية وتقييم ازدحام القنوات.'},
      {front:'Coverage Hole Detection؟', back:'كشف فجوات', ex:'يراقب ضعف التغطية ويقترح زيادة طاقة/نقاط.'},

      // — الأوامر (WLC/AP/SOHO) —
      {front:'أمر ملخص الشبكات اللاسلكية (WLC)?', back:'show wlan summary', ex:'يعرض قائمة WLAN/SSID والحالة والأمان.'},
      {front:'ملخص نقاط الوصول (WLC)?', back:'show ap summary', ex:'يعرض عدد الـAPs وحالتها وإصداراتها.'},
      {front:'ملخص العملاء المتصلين (WLC)?', back:'show wireless client summary', ex:'عدد/حالة العملاء وMAC/SSID بشكل موجز.'},
      {front:'إحصاءات 2.4GHz/5GHz (WLC)?', back:'show controllers dot11 24/5ghz', ex:'يعرض قنوات/قدرة/أخطاء للواجهات اللاسلكية.'},
      {front:'تفاصيل WLAN محددة (WLC)?', back:'show wlan id <X>', ex:'يعطي أمان/QoS/واجهة/SSID للمعرّف المطلوب.'},
      {front:'وضع FlexConnect على AP؟', back:'show capwap client', ex:'يُظهر حالة CAPWAP/وضع AP والاتصال بالمتحكّم.'},
      {front:'عرض الارتباطات اللاسلكية (AP)?', back:'show dot11 associations', ex:'قائمة العملاء المرتبطين ومعدّلاتهم.'},
      {front:'حالة راديو AP (AP)?', back:'show controllers dot11radio 0/1', ex:'تفاصيل التردد/القناة/الطاقة والأخطاء.'},
      {front:'سطر تشغيل WLAN (WLC/IOS‑XE)?', back:'show running-config | sec wlan', ex:'يعرض مقطع إعدادات WLAN/SSID والسياسات.'},
      {front:'مقترح تصحيح تداخل (أداة)', back:'site survey/chan plan', ex:'استخدم نتائج المسح لتعديل قنوات/طاقة AP.'}
    ];

    // ===== 2) عناصر DOM =====
    const els = {
      front: document.getElementById('front'),
      back: document.getElementById('back'),
      card: document.getElementById('card'),
      idx: document.getElementById('idx'),
      total: document.getElementById('total'),
      bar: document.getElementById('bar'),
      btnFlip: document.getElementById('btnFlip'),
      btnPrev: document.getElementById('btnPrev'),
      btnNext: document.getElementById('btnNext'),
      btnGood: document.getElementById('btnGood'),
      btnBad: document.getElementById('btnBad'),
      btnShuffle: document.getElementById('btnShuffle'),
      exBox: document.getElementById('ex'),
      exText: document.getElementById('exText'),
      timer: document.getElementById('timer'),
      // quiz
      mins: document.getElementById('mins'),
      btnStartQuiz: document.getElementById('btnStartQuiz'),
      quizInfo: document.getElementById('quizInfo'),
      quizSetup: document.getElementById('quizSetup'),
      quizView: document.getElementById('quizView'),
      qFront: document.getElementById('qFront'),
      qidx: document.getElementById('qidx'),
      qtotal: document.getElementById('qtotal'),
      score: document.getElementById('score'),
      ansInput: document.getElementById('ansInput'),
      btnSubmit: document.getElementById('btnSubmit'),
      btnSkip: document.getElementById('btnSkip'),
      quizFeedback: document.getElementById('quizFeedback'),
      quizTimer: document.getElementById('quizTimer'),
      tfBtns: document.getElementById('tfBtns'),
      btnTrue: document.getElementById('btnTrue'),
      btnFalse: document.getElementById('btnFalse'),
      quizSummary: document.getElementById('quizSummary'),
      summaryText: document.getElementById('summaryText'),
      btnRetry: document.getElementById('btnRetry'),
      btnBackStudy: document.getElementById('btnBackStudy'),
      studyView: document.getElementById('studyView'),
    };

    // ===== 3) دراسة البطاقة =====
    let i = 0;
    const STORAGE_KEY = 'wlan-known-v1';
    let known = new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'));

    function updateExplain(){
      const flipped = els.card.classList.contains('flipped');
      const hasEx = !!cards[i].ex;
      if(flipped && hasEx){ els.exText.textContent = cards[i].ex; els.exBox.classList.remove('hidden'); }
      else { els.exBox.classList.add('hidden'); els.exText.textContent = ''; }
    }
    function render(){
      els.total.textContent = cards.length;
      els.idx.textContent = i + 1;
      els.front.textContent = cards[i].front;
      els.back.textContent  = cards[i].back;
      const progress = (known.size / cards.length) * 100; els.bar.style.width = progress + '%';
      els.card.classList.remove('flipped');
      updateExplain();
    }
    function flip(){ els.card.classList.toggle('flipped'); updateExplain(); }
    function next(){ i = (i + 1) % cards.length; render(); }
    function prev(){ i = (i - 1 + cards.length) % cards.length; render(); }
    function markKnown(){ known.add(i); localStorage.setItem(STORAGE_KEY, JSON.stringify([...known])); next(); }
    function markUnknown(){ known.delete(i); localStorage.setItem(STORAGE_KEY, JSON.stringify([...known])); next(); }
    function shuffle(){ for(let j = cards.length - 1; j > 0; j--){ const k = Math.floor(Math.random() * (j + 1)); [cards[j], cards[k]] = [cards[k], cards[j]]; } i = 0; render(); }

    els.btnFlip.addEventListener('click', flip);
    els.btnNext.addEventListener('click', next);
    els.btnPrev.addEventListener('click', prev);
    els.btnGood.addEventListener('click', markKnown);
    els.btnBad.addEventListener('click', markUnknown);
    els.btnShuffle.addEventListener('click', shuffle);

    document.addEventListener('keydown', (e)=>{
      if(e.code === 'Space'){ e.preventDefault(); flip(); }
      else if(e.key === 'ArrowRight'){ next(); }
      else if(e.key === 'ArrowLeft'){ prev(); }
      else if(e.key === '1'){ markKnown(); }
      else if(e.key === '2'){ markUnknown(); }
    });

    // ===== 4) وضع الاختبار =====
    let quiz = { order: [], idx: 0, score: 0, total: 0, running: false, endAt: 0, tHandle: null };

    function normalize(s){
      return (s||'')
        .toString()
        .trim()
        .toLowerCase()
        .replace(/[\u200f\u200e]/g,'') // علامات اتجاه
        .replace(/[\u0610-\u061a\u064b-\u065f\u06d6-\u06ed]/g,'') // تشكيل
        .replace(/[–—−]/g,'-')
        .replace(/\s+/g,' ');
    }

    const synonyms = {
      'شبكة محلية لاسلكية':['wlan','شبكة محلية لاسلكية'],
      'ieee 802.11':['ieee 802.11','802.11','واي فاي','wifi'],
      'l1/l2':['l1/l2','l1 l2','physical/data link','physical & data link'],
      'sta':['sta','محطة','عميل'],
      'ap':['ap','نقطة وصول','اكسس بوينت'],
      'اسم الشبكة':['اسم الشبكة','ssid'],
      'mac للـap':['bssid','mac للـap','bssid mac'],
      '2.4/5 ghz':['2.4/5 ghz','2.4 و5'],
      '1/6/11':['1/6/11','1 6 11'],
      '20/40/80 mhz':['20/40/80 mhz','20 40 80'],
      'csma/ca':['csma/ca','csma ca'],
      'رادارات':['dfs','تحاشي الرادارات','رادارات'],
      'قوة الإشارة':['rssi','قوة الإشارة'],
      'نسبة إشارة/ضجيج':['snr','نسبة إشارة/ضجيج'],
      'ارتباط':['association','ارتباط'],
      'تنقّل':['roaming','تنقل','تنقّل'],
      'تداخل نفس القناة':['cci','تداخل نفس القناة'],
      'تداخل قنوات مجاورة':['aci','تداخل قنوات مجاورة'],
      'sae':['sae','wpa3 sae'],
      'radius':['radius','aaa'],
      'aes':['aes','ccmp'],
      'wmm':['wmm','wifi multimedia'],
      'edca':['edca','hcca edca','edca/hcca'],
      'local/monitor':['local/monitor','local','monitor'],
      'router+ap+switch':['router+ap+switch','soho router'],
      'show wlan summary':['show wlan summary','wlan summary'],
      'show ap summary':['show ap summary','ap summary'],
      'show wireless client summary':['show wireless client summary','client summary'],
      'show controllers dot11 24/5ghz':['show controllers dot11 24/5ghz','controllers dot11'],
      'show wlan id <x>':['show wlan id <x>','show wlan id'],
      'show capwap client':['show capwap client','capwap client'],
      'show dot11 associations':['show dot11 associations','dot11 associations'],
      'show controllers dot11radio 0/1':['show controllers dot11radio 0/1','controllers dot11radio'],
      'show running-config | sec wlan':['show running-config | sec wlan','show run sec wlan'],
      'site survey/chan plan':['site survey/chan plan','site survey','channel plan']
    };

    function eq(a,b){
      a = normalize(a); b = normalize(b);
      if(a===b) return true;
      // نعم/لا ↔ صح/خطأ
      if((b==='نعم' && (a==='صح' || a==='نعم')) || (b==='لا' && (a==='خطأ' || a==='لا'))) return true;
      for(const key in synonyms){ if(b===key && synonyms[key].includes(a)) return true; }
      return false;
    }

    function startTimer(mins){ const ms = mins*60*1000; quiz.endAt = Date.now()+ms; updateTimer(); quiz.tHandle = setInterval(updateTimer, 250); }
    function stopTimer(){ if(quiz.tHandle){ clearInterval(quiz.tHandle); quiz.tHandle=null; } els.quizTimer.textContent='—'; }
    function updateTimer(){ const remain = Math.max(0, quiz.endAt - Date.now()); const m = Math.floor(remain/60000); const s = Math.floor((remain%60000)/1000); els.quizTimer.textContent = `${m}:${String(s).padStart(2,'0')}`; els.timer.textContent = `⏱️ ${m}:${String(s).padStart(2,'0')}`; if(remain<=0){ finishQuiz(); } }

    function show(el){ el.classList.remove('hidden'); }
    function hide(el){ el.classList.add('hidden'); }

    function beginQuiz(){
      quiz.order = Array.from(cards.keys());
      for(let j = quiz.order.length-1; j>0; j--){ const k = Math.floor(Math.random()*(j+1)); [quiz.order[j], quiz.order[k]] = [quiz.order[k], quiz.order[j]]; }
      quiz.idx = 0; quiz.score = 0; quiz.total = quiz.order.length; quiz.running = true; els.qtotal.textContent = quiz.total;
      els.score.textContent = '0'; els.qidx.textContent = '1'; els.quizFeedback.textContent = '';
      hide(els.quizSetup); show(els.quizView); hide(els.quizSummary); hide(els.studyView);
      loadQuestion();
      const mins = Math.max(1, Math.min(60, parseInt(els.mins.value||'10',10)));
      startTimer(mins);
      els.quizInfo.textContent = `تم بدء اختبار بـ ${mins} دقيقة`;
    }

    function loadQuestion(){
      const idx = quiz.order[quiz.idx]; const c = cards[idx];
      els.qFront.textContent = c.front;
      els.ansInput.value=''; els.ansInput.focus();
      const b = normalize(c.back);
      if(b === 'صح' || b === 'خطأ' || b==='نعم' || b==='لا'){ show(els.tfBtns); } else { hide(els.tfBtns); }
    }

    function checkAnswer(userAns){
      const idx = quiz.order[quiz.idx]; const c = cards[idx];
      const a = normalize(userAns);
      let b = normalize(c.back);
      if(['yes','صح','نعم','true'].includes(b)) b = 'نعم';
      if(['no','خطأ','لا','false'].includes(b)) b = 'لا';

      const ok = (a===b) || eq(a,b);
      if(ok){ quiz.score++; els.quizFeedback.innerHTML = '✅ إجابة صحيحة'; }
      else{ els.quizFeedback.innerHTML = `❌ الصحيح: <span class="kbd">${c.back}</span>` + (c.ex? `<br/><span class="small muted">${c.ex}</span>`:''); }
      els.score.textContent = String(quiz.score);
      quiz.idx++;
      if(quiz.idx >= quiz.total){ finishQuiz(); }
      else { els.qidx.textContent = String(quiz.idx+1); loadQuestion(); }
    }

    function finishQuiz(){
      if(!quiz.running) return; quiz.running = false; stopTimer();
      hide(els.quizView); show(els.quizSummary);
      const percent = Math.round((quiz.score/quiz.total)*100);
      els.summaryText.innerHTML = `أنهيت الاختبار: <strong>${quiz.score}</strong> من <strong>${quiz.total}</strong> — الدرجة: <strong>${percent} / 100</strong>`;
    }

    // روابط أحداث الاختبار
    els.btnStartQuiz.addEventListener('click', beginQuiz);
    els.btnSubmit.addEventListener('click', ()=>{ checkAnswer(els.ansInput.value); });
    els.btnSkip.addEventListener('click', ()=>{ checkAnswer('___'); });
    els.btnTrue.addEventListener('click', ()=> checkAnswer('نعم'));
    els.btnFalse.addEventListener('click', ()=> checkAnswer('لا'));
    els.btnRetry.addEventListener('click', ()=>{ show(els.quizSetup); hide(els.quizSummary); hide(els.studyView); });
    els.btnBackStudy.addEventListener('click', ()=>{ show(els.studyView); hide(els.quizSetup); hide(els.quizSummary); stopTimer(); });

    // ===== 5) اختبارات Console =====
    (function selfTests(){
      const tests = [];
      function t(name, fn){ try{ fn(); tests.push({name, ok:true}); } catch(e){ tests.push({name, ok:false, msg:e.message}); } }
      t('cards: مصفوفة بطول 60', ()=>{ if(!Array.isArray(cards) || cards.length !== 60) throw new Error('عدد البطاقات يجب أن يكون 60'); });
      t('كل بطاقة تحتوي front/back', ()=>{ cards.forEach(c=>{ if(typeof c.front!== 'string' || typeof c.back!=='string') throw new Error('front/back نوع غير نصي'); }); });
      t('شرح مختصر ≤ سطرين تقريبًا', ()=>{ cards.forEach(c=>{ if(c.ex && c.ex.length>240) throw new Error('شرح طويل'); }); });
      t('localStorage يعمل', ()=>{ localStorage.setItem('__t','1'); if(localStorage.getItem('__t')!=='1') throw new Error('تعذّر'); localStorage.removeItem('__t'); });
      console.log('%c[Flashcards WLAN 60] Self-tests:', 'color:#7dd3fc');
      tests.forEach(r=> console.log(r.ok ? '✅ '+r.name : '❌ '+r.name+' — '+r.msg));
    })();

    // بدء العرض
    render();
  </script>
</body>
</html>
